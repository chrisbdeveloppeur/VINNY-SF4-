<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="BOUNGOU Christian">
        <title>{% block title %}Welcome!{% endblock %}</title>

        <script src="https://cdn.plyr.io/3.5.10/plyr.polyfilled.js"></script>
        <link rel="shortcut icon" type="image/png" href="{{ asset('build/images/vinny_logo_circulo_favicon.ec1beae4.png') }}"/>
        <link rel="icon" href="{{ asset('build/images/vinny_logo_circulo_favicon.ec1beae4.png') }}" type="image/png">
        <link rel="stylesheet" href="https://cdn.plyr.io/3.5.10/plyr.css" />
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
        <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>


        {% block fonts %}
            <link href="https://fonts.googleapis.com/css?family=Caveat|Handlee|Permanent+Marker&display=swap" rel="stylesheet">
            <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300i,400,400i,700,700i,900,900i&display=swap" rel="stylesheet">
            <link href="https://fonts.googleapis.com/css?family=Teko:300,400,500,600,700&display=swap" rel="stylesheet">
            <link href="https://fonts.googleapis.com/css2?family=Khand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
            <link href="https://fonts.googleapis.com/css2?family=Rubik+Mono+One&display=swap" rel="stylesheet">
            <link href="https://fonts.googleapis.com/css2?family=Days+One&display=swap" rel="stylesheet">
        {% endblock %}

        {% block css %}
            {{ encore_entry_link_tags('app') }}
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
{#            <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>#}
        {% endblock %}
    </head>
    <body class="has-background-white-bis">
        {% block body %}

            <div style="z-index: 2;position: sticky;top: 0;">
                {% block header %}
                    {% if is_granted('ROLE_USER') %}

                        {% include('includes/header/admin_header.html.twig') %}

                    {% else %}

                        {% include('includes/header/header.html.twig') %}

                    {% endif %}

                        <section class="" style="z-index:1;background:#121212 center / 100% 100% no-repeat url('{{ asset('build/images/audio_bars.62a6b06d.png')}}');width: 100%">
                            <div class="has-text-centered" style="position: relative">

                                    <h1 class="title has-text-weight-bold has-text-black-bis is-uppercase is-family-code is-size-1-touch" style="text-shadow:rgb(205, 201, 255) 0px 0px 5px;margin:0;position: relative;z-index: 3">

                                        {% block titre %}

                                        {% endblock %}
                                    </h1>

{#                                <input style="position: absolute;left: 5px;top: 5px;" type="file" id="thebeat" accept="audio/*" />#}
{#                                <canvas style="position: absolute;left: 0;top: 0;z-index: -1" id="canvas"></canvas>#}

                                    {% if is_granted('ROLE_USER') %}

                                    <input style="position: absolute;left: 5px;top: 5px;" type="file" id="thefile" accept="audio/*" />
                                    <canvas style="position: absolute;left: 0;top: 0;z-index: 0" id="canvas"></canvas>

                                    {% endif %}

                            </div>

                        </section>

                    {% block audiocontrol %}
                        {% if is_granted('ROLE_USER') %}
                            <audio style="box-shadow: black 0 0 20px 1px;background:#121212;width: 100%;height: 25px" id="audio" controls></audio>
                        {% else %}
                            <div style="box-shadow: black 0 0 20px 1px;background: #121212;width: 100%;height: 5px;">

                            </div>
                        {% endif %}
                    {% endblock %}

                {% endblock %}
            </div>





            <div style="position:fixed;top:0;width: 100%;min-height: 100vh;background:center / cover no-repeat url('{{ asset('build/images/headphones.64ab74be.jpg')}}')">
                <div class="layer" style="height: 100vh;width: 100vw; background: rgb(255,255,255);
                                                                    background: -moz-linear-gradient(180deg, rgba(255,255,255,0.748319396117822) 20%, rgba(203,224,255,0.499019676229867) 50%, rgba(255,255,255,0.748319396117822) 80%);
                                                                    background: -webkit-linear-gradient(180deg, rgba(255,255,255,0.748319396117822) 20%, rgba(203,224,255,0.499019676229867) 50%, rgba(255,255,255,0.748319396117822) 80%);
                                                                    background: linear-gradient(180deg, rgba(255,255,255,0.748319396117822) 20%, rgba(203,224,255,0.499019676229867) 50%, rgba(255,255,255,0.748319396117822) 80%);
                                                                    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#ffffff",endColorstr="#ffffff",GradientType=1); ">

                </div>
            </div>


                <section class="container is-flex justify-content-center align-items-center" style="min-height: 80vh;position:relative">
                        <div class="column">
                    {% block content %}

                    {% endblock %}
                        </div>
                </section>




            {% block footer %}

                {% include('includes/footer/footer.html.twig') %}

            {% endblock %}

        {% endblock %}



        {% block javascripts %}



            {#        SCRIPT POUR VERIF NOMBRE DANS FORMULAIRE          #}
            <script>
                function verif_nombre(champ)
                {
                    var chiffres = new RegExp("[0-9]");
                    var verif;
                    var points = 0;

                    for(x = 0; x < champ.value.length; x++)
                    {
                        verif = chiffres.test(champ.value.charAt(x));
                        if(champ.value.charAt(x) == "."){points++;}
                        if(points > 1){verif = false; points = 1;}
                        if(verif == false){champ.value = champ.value.substr(0,x) + champ.value.substr(x+1,champ.value.length-x+1); x--;}
                    }
                }

                function verif_nombre_max(champ, max){

                    let x = champ.value;
                    let xsub = x.toString().substr(0,max);
                    champ.value = xsub;

                }
            </script>
            {#        FIN DE SCRIPT         #}





            <script>
                $(document).ready(function(){
                    $('#nav-icon0,#nav-icon1,#nav-icon2,#nav-icon3,#nav-icon4').click(function(){
                        $(this).toggleClass('open');
                    });
                });
            </script>



            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
            <script type="text/javascript">
                $(document).ready(function () {
                    $("audio").on("contextmenu",function(e){
                        return false;
                    });
                });
            </script>





            {#      SCRIPT POUR FILTRE BEATS      #}

            <script>
                filterSelection("all")
                function filterSelection(c) {
                    var x, i;
                    x = document.getElementsByClassName("filterDiv");
                    if (c === "all") c = "";
                    // Add the "show" class (display:block) to the filtered elements, and remove the "show" class from the elements that are not selected
                    for (i = 0; i < x.length; i++) {
                        w3RemoveClass(x[i], "show");
                        if (x[i].className.indexOf(c) > -1) w3AddClass(x[i], "show");
                    }
                }

                // Show filtered elements
                function w3AddClass(element, name) {
                    var i, arr1, arr2;
                    arr1 = element.className.split(" ");
                    arr2 = name.split(" ");
                    for (i = 0; i < arr2.length; i++) {
                        if (arr1.indexOf(arr2[i]) == -1) {
                            element.className += " " + arr2[i];
                        }
                    }
                }

                // Hide elements that are not selected
                function w3RemoveClass(element, name) {
                    var i, arr1, arr2;
                    arr1 = element.className.split(" ");
                    arr2 = name.split(" ");
                    for (i = 0; i < arr2.length; i++) {
                        while (arr1.indexOf(arr2[i]) > -1) {
                            arr1.splice(arr1.indexOf(arr2[i]), 1);
                        }
                    }
                    element.className = arr1.join(" ");
                }

                // Add active class to the current control button (highlight it)
                var btnContainer = document.getElementById("myBtnContainer");
                var btns = btnContainer.getElementsByClassName("button");
                for (var i = 0; i < btns.length; i++) {
                    btns[i].addEventListener("click", function() {
                        var current = document.getElementsByClassName("active");
                        current[0].className = current[0].className.replace(" active", "");
                        this.className += " active";
                    });
                }
            </script>

            {#      FIN SCRIPT POUR FILTRE BEATS      #}




            {#  SCRIPT VISU SOUND WAVE    #}

            <script>


                // let Beat = document.getElementsByClassName("js-player");
                //
                // for (i=0;i<Beat.length;i++){
                //     // Beat[i].addEventListener("play", targetBeat(Beat[i]));
                //     Beat[i].onplay
                // }
                //
                // function targetBeat(selectedBeat){
                //     console.log(selectedBeat.currentSrc);
                // }



                window.onload = function() {

                    var file = document.getElementById("thefile");

                    var audio = document.getElementById("audio");

                    file.onchange = function() {
                        var files = this.files;
                        audio.src = URL.createObjectURL(files[0]);
                        audio.load();
                        audio.play();
                        var context = new AudioContext();
                        var src = context.createMediaElementSource(audio);
                        var analyser = context.createAnalyser();

                        var canvas = document.getElementById("canvas");
                        canvas.width = window.innerWidth;
                        canvas.height = window.innerHeight * 0.3 ;
                        var ctx = canvas.getContext("2d");

                        src.connect(analyser);
                        analyser.connect(context.destination);

                        analyser.fftSize = 512;

                        var bufferLength = analyser.frequencyBinCount;
                        // console.log(bufferLength);

                        var dataArray = new Uint8Array(bufferLength);

                        var WIDTH = canvas.width;
                        var HEIGHT = canvas.height;

                        var barWidth = (WIDTH / bufferLength) * 2.5;
                        var barHeight;
                        var x = 0;

                        function renderFrame() {
                            requestAnimationFrame(renderFrame);

                            x = 0;

                            analyser.getByteFrequencyData(dataArray);

                            ctx.fillStyle = "#121212";
                            ctx.strokeStyle = "rgba(0,0,0,1)";
                            ctx.lineCap = 'round';
                            ctx.fillRect(0, 0, WIDTH, HEIGHT);

                            for (var i = 0; i < bufferLength; i++) {
                                barHeight = dataArray[i];

                                var r = barHeight;
                                var g = barHeight;
                                var b = 2;

                                ctx.fillStyle = "rgb(" + r + "," + g + ",255)";
                                ctx.lineCap = 'round';
                                ctx.fillRect(x, HEIGHT - barHeight, barWidth, barHeight);

                                x += barWidth + 1;
                            }
                        }

                        audio.play();
                        renderFrame();
                    };
                };
            </script>

            {# FIN SCRIPT VISU SOUND WAVE    #}

            <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>

            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>

            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

            <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js" type="text/javascript" ></script>

{#            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" type="text/javascript" ></script>#}

            <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" type="text/javascript" ></script>

            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js" type="text/javascript" ></script>

            {#     SCRIPT POUR COOKIE CONSENT     #}
            <script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script>
            <script>
                window.cookieconsent.initialise({
                    "palette": {
                        "popup": {
                            "background": "rgba(0,0,0,0.8)"
                        },
                        "button": {
                            "background": "#30aae4"
                        }
                    },
                    "showLink": false,
                    "theme": "edgeless",
                    "position": "bottom-right",
                    "type": "opt-out"
                });
            </script>

{#            <script>#}
{#                window.cookieconsent.initialise({#}
{#                    "palette": {#}
{#                        "popup": {#}
{#                            "background": "rgba(0,0,0,0.8)"#}
{#                        },#}
{#                        "button": {#}
{#                            "background": "#f1d600"#}
{#                        }#}
{#                    },#}
{#                    "showLink": false,#}
{#                    "theme": "edgeless",#}
{#                    "position": "bottom-right",#}
{#                    "type": "opt-out",#}
{#                    "content": {#}
{#                        "message": "Nous utilisons des cookies pour nous permettre de mieux comprendre comment le site est utilisé.\nEn continuant à utiliser ce site, vous acceptez cette politique. ",#}
{#                        "dismiss": "Ok",#}
{#                        "allow": "Autoriser",#}
{#                        "deny": "Refuser",#}
{#                        "link": "en savoir plus"#}
{#                    }#}
{#                });#}
{#            </script>#}
            {#    FIN SCRIPT POUR COOKIE CONSENT     #}

        {% endblock %}
    </body>
</html>
